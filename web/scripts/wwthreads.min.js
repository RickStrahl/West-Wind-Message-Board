window.wwthreads=null,function(){function f(n){wwthreads.userData.load();(navigator.userAgent.indexOf("MSIE 9")>-1||navigator.userAgent.indexOf("MSIE 8")>-1||navigator.userAgent.indexOf("MSIE 7")>-1)&&$(document.body).addClass("old-ie");u(n);$(document.body).on("click","#slide-menu-toggle",e);$(document.body).on("dblclick touchend",".splitter",e);$(".sidebar-left").resizable({handleSelector:".splitter",resizeHeight:!1});window.onpopstate=function(){history.state.URL&&o(history.state.URL)};$("#MessageList").on("click",".message-item,.message-item >a",o);$(document.body).on("click","#Refresh-Button",function(){u(!0).then(function(){toastr.success("Thread listing updated.")},function(){toastr.error("Updating of the thread listing failed.")})});$(document.body).on("click","#Search-Button,#Search-Button-Close",function(){$(".message-search-box").toggle()});$(".sidebar-left").on("click","#Search-Button-Submit",s);$(".sidebar-left").on("click","#Search-Button-Clear",h);setTimeout(function(){$(".main-content").on("click","#MessageOrderDown",function(){return i(!0),wwthreads.userData.save(),!1});$(".main-content").on("click","#MessageOrderUp",function(){return i(!1),wwthreads.userData.save(),!1})},2e3);i(wwthreads.userData.sortAscending)}function e(t){if(t.type==="touchend"&&!n)return n=!0,setTimeout(function(){n=!1},300),!1;var i=$(".sidebar-left"),r=i.css("transition");return i.css("transition","width 0.5s ease-in-out"),i.width()<20?(i.show(),i.width(400)):i.width(0),setTimeout(function(){i.css("transition",r)},700),!0}function u(n){var i,r,u;if(getUrlEncodedKey("rl",location.search)&&(n=!0),i=null,n||(i=wwthreads.userData.getThreadMessages()),i)t(i);else return r=getUrlEncodedKey("forum",location.search),u="ThreadList.wwt"+(r?"?forum="+r:""),$.get(u,function(n){wwthreads.userData.lastAccess=new Date;wwthreads.userData.threadMessages=n;wwthreads.userData.save();t(n)})}function t(n){var t=$("<div>"+getBodyFromHtmlDocument(n)+"<\/div>").find(".message-list-container"),i=t.html();return $("#MessageList").html(t.html(i)),$(".forum-list-header").click(function(){var t=$(this).next(),n;t.toggle();n=$(this).find("span");n.text()=="+"?n.text("-"):n.text("+")}),$(".expand-forum").click(function(){$(this).find("span").text("-");$(".forum-list-container").hide();$(".forum-list-header").find("span").text("+");var n=$(this).next();n.show(600)}),$("#StartDate,#EndDate").datetimepicker({format:"MM/DD/YYYY",keyBinds:{"delete":null}}),!1}function o(n){var r=!0,t,u;return typeof n!="string"&&(r=!1,t=$(this),u=t.data("id"),n="Thread"+u+".wwt",$(".message-item").removeClass("selected"),t.addClass("selected")),$.get(n,function(t){var f=$(t),e=t.extract("<title>","<\/title>"),u;if(window.document.title=e,u=f.find(".main-content"),u.length>0)t=u.html(),$(".main-content").html(t),wwthreads.sortAscending=!0,window.history.pushState&&!r&&window.history.pushState({title:"",URL:n},"",n),$(".main-content").scrollTop(0),window.outerWidth<769&&$(".sidebar-left").width(0);else return;wwthreads.highlightCode();i(wwthreads.userData.sortAscending)}),!1}function i(n){var i=wwthreads.userData.sortAscending,t;wwthreads.userData.sortAscending=typeof n=="boolean"?n:!wwthreads.userData.sortAscending;t=$(".message-list-item");t.sort(function(n,t){var r=n.getAttribute("data-sort")*1,u=t.getAttribute("data-sort")*1,i=1;return(wwthreads.userData.sortAscending||(i=-1),r>u)?1*i:r<u?-1*i:0});t.detach().appendTo("#ThreadMessageList");wwthreads.userData.sortAscending!==i&&(toastr.clear(),toastr.success("Message order has been reversed to "+(wwthreads.userData.sortAscending?"ascending":"descending")+".","Thread Message Order"));$("#SortContainer .fa").removeClass("selected");wwthreads.userData.sortAscending?$("#MessageOrderDown").addClass("selected"):$("#MessageOrderUp").addClass("selected")}function s(){$.post("ThreadList.wwt",{StartDate:$("#StartDate_field").val(),EndDate:$("#EndDate_field").val(),Forum:$("#Forum").val(),Search:$("#Search").val(),MsgId:$("#MsgId").val(),FromName:$("#FromName").val()},t)}function h(){$("#StartDate_field").val("");$("#EndDate_field").val("");$("#Forum").val("");$("#Search").val("");$("MsgId").val("");$("#FromName").val("");$.post("ThreadList.wwt",t)}var r,n;wwthreads={initializeLayout:f,highlightCode:null,loadMessages:u,userData:{lastAccess:new Date,lastMessageText:null,threadMessages:null,savedTime:(new Date).getTime()-31e4,sortAscending:!0,save:function(){wwthreads.userData.savedTime=(new Date).getTime();localStorage&&localStorage.setItem("wwt_userdata",JSON.stringify(wwthreads.userData))},load:function(){if(localStorage){var n=localStorage.getItem("wwt_userdata");if(n)try{n=JSON.parseWithDate(n);$.extend(wwthreads.userData,n)}catch(t){localStorage.removeItem("wwt_userdata")}}},getThreadMessages:function(){return wwthreads.userData.savedTime<(new Date).getTime()-3e5?null:wwthreads.userData.threadMessages}}};r=!1;location.pathname.indexOf(".wwt")<1&&(r=!0);f(r);n=!1}();