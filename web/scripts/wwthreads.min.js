window.wwthreads=null,function(){function f(){wwthreads.userData.load();(navigator.userAgent.indexOf("MSIE 9")>-1||navigator.userAgent.indexOf("MSIE 8")>-1||navigator.userAgent.indexOf("MSIE 7")>-1)&&$(document.body).addClass("old-ie");i();$(document.body).on("click","#slide-menu-toggle",r);$(document.body).on("dblclick touchend",".splitter",r);$(".sidebar-left").resizable({handleSelector:".splitter",resizeHeight:!1});window.onpopstate=function(){history.state.URL&&u(history.state.URL)};$("#MessageList").on("click",".message-item,.message-item >a",u);$(document.body).on("click","#Refresh-Button",function(){i(!0).then(function(){toastr.success("Thread listing updated.")},function(){toastr.error("Updating of the thread listing failed.")})});$(document.body).on("click","#Search-Button,#Search-Button-Close",function(){$(".message-search-box").toggle()});$(".sidebar-left").on("click","#Search-Button-Submit",o);$(".sidebar-left").on("click","#Search-Button-Clear",s);$(".main-content").on("click","#ReverseMessageOrder",e)}function r(n){if(n.type==="touchend"&&!t)return t=!0,setTimeout(function(){t=!1},300),!1;var i=$(".sidebar-left"),r=i.css("transition");return i.css("transition","width 0.5s ease-in-out"),i.width()<20?(i.show(),i.width(400)):i.width(0),setTimeout(function(){i.css("transition",r)},700),!0}function i(t){var i,r,u;if(getUrlEncodedKey("rl",location.search)&&(t=!0),i=null,t||(i=wwthreads.userData.getThreadMessages()),i)n(i);else return r=getUrlEncodedKey("forum",location.search),u="ThreadList.wwt"+(r?"?forum="+r:""),$.get(u,function(t){wwthreads.userData.lastAccess=new Date;wwthreads.userData.threadMessages=t;wwthreads.userData.save();n(t)})}function n(n){var t=$("<div>"+getBodyFromHtmlDocument(n)+"<\/div>").find(".message-list-container"),i=t.html();return $("#MessageList").html(t.html(i)),$(".forum-list-header").click(function(){var t=$(this).next(),n;t.toggle();n=$(this).find("span");n.text()=="+"?n.text("-"):n.text("+")}),$(".expand-forum").click(function(){$(this).find("span").text("-");$(".forum-list-container").hide();$(".forum-list-header").find("span").text("+");var n=$(this).next();n.show(600)}),!1}function u(n){var i=!0,t,r;return typeof n!="string"&&(i=!1,t=$(this),r=t.data("id"),n="Thread"+r+".wwt",$(".message-item").removeClass("selected"),t.addClass("selected")),$.get(n,function(t){var u=$(t),f=t.extract("<title>","<\/title>"),r;if(window.document.title=f,r=u.find(".main-content"),r.length>0)t=r.html(),$(".main-content").html(t),wwthreads.sortAscending=!0,window.history.pushState&&!i&&window.history.pushState({title:"",URL:n},"",n),$(".main-content").scrollTop(0),window.outerWidth<769&&$(".sidebar-left").width(0);else return;wwthreads.highlightCode()}),!1}function e(){wwthreads.sortAscending=!wwthreads.sortAscending;var n=$(".message-list-item");n.sort(function(n,t){var r=n.getAttribute("data-sort")*1,u=t.getAttribute("data-sort")*1,i;return(console.log(r,u),i=1,wwthreads.sortAscending||(i=-1),r>u)?1*i:r<u?-1*i:0});n.detach().appendTo("#ThreadMessageList");toastr.clear();toastr.success("Message order has been reversed to "+(wwthreads.sortAscending?"ascending":"descending"),"Thread Message Order")}function o(){$.post("ThreadList.wwt",{StartDate:$("#StartDate_field").val(),EndDate:$("#EndDate_field").val(),Forum:$("#Forum").val(),Search:$("#Search").val(),MsgId:$("MsgId").val()},n)}function s(){$("#StartDate_field").val("");$("#EndDate_field").val("");$("#Forum").val("");$("#Search").val("");$("MsgId").val("");$.post("ThreadList.wwt",n)}wwthreads={initializeLayout:f,highlightCode:null,sortAscending:!0,loadMessages:i,userData:{lastAccess:new Date,lastMessageText:null,threadMessages:null,savedTime:(new Date).getTime()-31e4,sortAscending:!0,save:function(){wwthreads.userData.savedTime=(new Date).getTime();localStorage&&localStorage.setItem("wwt_userdata",JSON.stringify(wwthreads.userData))},load:function(){if(localStorage){var n=localStorage.getItem("wwt_userdata");if(n)try{n=JSON.parseWithDate(n);$.extend(wwthreads.userData,n)}catch(t){localStorage.removeItem("wwt_userdata")}}},getThreadMessages:function(){return wwthreads.userData.savedTime<(new Date).getTime()-3e5?null:wwthreads.userData.threadMessages}}};var t=!1}();