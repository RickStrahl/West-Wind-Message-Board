<?xml version="1.0"?>
<configuration>
  <configSections>
    <section name="webConnectionConfiguration" type="System.Configuration.NameValueSectionHandler,System,Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>
    <section name="webConnectionVisualStudio" type="System.Configuration.NameValueSectionHandler,System,Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/>
  </configSections>
  <appSettings>
    <add key="enableSimpleMembership" value="false"/>
  </appSettings>
  <webConnectionConfiguration>
    <!-- NOTE: These settings apply only to the Web Connection Managed Module! -->
    <add key="MessagingMechanism" value="File"/>
    <add key="Timeout" value="90"/>
    <add key="TempPath" value="~\..\deploy\temp\"/>
    <add key="TempFilePrefix" value="WC_"/>
    <add key="ComServerProgId" value="wwThreads.wwThreadsServer"/>
    <add key="ComServerLoadingMode" value="LoadBased"/>
    <add key="ServerCount" value="2"/>
    <add key="AutoStartServers" value="False"/>
    <add key="ExeFile" value="~\..\deploy\Wwthreads.exe"/>
    <add key="UpdateFile" value="~\..\deploy\Wwthreads_Update.exe"/>
    <add key="AdminAccount" value="ANY"/>
    <add key="AdminPage" value="~/admin/admin.aspx"/>
    <add key="LogDetail" value="False"/>
    <add key="ValidateRequest" value="False"/>
    <add key="MessageDisplayFooter" value="Generated by Web Connection IIS .NET Connector Module"/>
    <add key="UseCustomManifestLoading" value="False"/>
    <add key="AuthenticationMode" value="Default"/>
    <add key="PassAspNetContext" value="False"/>
  </webConnectionConfiguration>
  <webConnectionVisualStudio>
    <!-- Configuration Settings for the Web Connection Visual Studio Add-in 
       Not used at runtime, only at the design time -->
    <add key="FoxProjectBasePath" value="c:\WebConnectionProjects\wwThreads\"/>
    <add key="WebProjectBasePath" value="c:\WebConnectionProjects\wwThreads\Web\"/>
    <add key="WebProjectVirtual" value="http://localhost/wwThreads2/"/>
    <!-- Optional PRG launched when VFP IDE launches -->
    <add key="IdeOnLoadPrg" value=""/>
    <!-- The default browser used. Blank IE Automation, otherwise specify browser exe path -->
    <add key="WebBrowser" value=""/>
    <!-- <add key="WebBrowserAlternate" value="C:\Program Files (x86)\mozilla firefox\firefox.exe" /> -->
    <add key="WebBrowserAlternate" value="C:\Program Files (x86)\Google\Chrome\Application\chrome.exe"/>
    <!-- The editor used to edit FoxPro code - blank means FoxPro Editor is used -->
    <add key="FoxProEditor" value=""/>
    <add key="FoxProEditorAlternate" value="C:\Program Files\Sublime Text 3\sublime_text.exe"/>
  </webConnectionVisualStudio>
  <system.web>
    <compilation defaultLanguage="c#" debug="true" targetFramework="4.0">
      <!-- Build Providers enable your script extensions to be editable in Visual Studio -->
      <buildProviders>
        <add extension=".wcsx" type="System.Web.Compilation.PageBuildProvider"/>
        <add extension=".wc" type="System.Web.Compilation.PageBuildProvider"/>
        <add extension=".wwThreads2" type="System.Web.Compilation.PageBuildProvider"/>
      </buildProviders>
    </compilation>
    <!-- Web Connection Managed Module requires that it runs in FULL TRUST (COM Interop) -->
    <trust level="Full"/>
    <httpHandlers/>
    <pages controlRenderingCompatibilityVersion="3.5" clientIDMode="AutoID"/>
  </system.web>
  <!-- IIS 7 Script Map Configuration -->
  <system.webServer>
    <!-- use this on IIS 7.5 and later to bypass IIS default Error handlers for failures -->
    <!-- httpErrors existingResponse="PassThrough" /-->
    <!-- IIS 7 Script Map Configuration -->
    <handlers>
      <add name=".wwt_wconnect-module" path="*.wwt" verb="*" type="Westwind.WebConnection.WebConnectionHandler,WebConnectionModule" preCondition="integratedMode"/>
      <add name=".wc_wconnect-module" path="*.wc" verb="*" type="Westwind.WebConnection.WebConnectionHandler,WebConnectionModule" preCondition="integratedMode"/>
      <add name=".wcs_wconnect-module" path="*.wcs" verb="*" type="Westwind.WebConnection.WebConnectionHandler,WebConnectionModule" preCondition="integratedMode"/>
      <add name=".wcsx_wconnect-module" path="*.wcsx" verb="*" type="Westwind.WebConnection.WebConnectionHandler,WebConnectionModule" preCondition="integratedMode"/>
      <add name=".wwsoap_wconnect-module" path="*.wwsoap" verb="*" type="Westwind.WebConnection.WebConnectionHandler,WebConnectionModule" preCondition="integratedMode"/>
    </handlers>
    <defaultDocument>
      <files>
        <add value="threads.wwt"/>
      </files>
    </defaultDocument>
    <!-- 
      EXTENSIONLESS URL HANDLING
      - Requires IIS Url Rewrite Module 2.0 (Web Platform Installer)

      matches any URLs that do not have a '.' in the path    
  -->
    <!--
    <rewrite>
      <rules>
        <rule name="ExtensionlessUrl" patternSyntax="ECMAScript" stopProcessing="true">          
          <match url=".[^.]*$"  />
          <conditions>
            <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
            <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
          </conditions>
          <action type="Rewrite" url="api/UrlRewriteHandler.av" appendQueryString="true" />
        </rule>
      </rules>
    </rewrite>    
  -->
  </system.webServer>
</configuration>